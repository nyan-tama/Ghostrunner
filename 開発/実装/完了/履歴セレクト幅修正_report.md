# 履歴セレクト幅修正 - モバイル表示のレイアウト崩れ修正

---

## 実装完了レポート

### 実装サマリー
- **実装日**: 2026-01-27
- **変更ファイル数**: 1 file
- **対象**: フロントエンド (`frontend/`) のみ
- **種別**: UIバグ修正（モバイルレイアウト）

### 変更ファイル一覧

| ファイル | 変更内容 |
|---------|---------|
| `frontend/src/components/CommandForm.tsx` | Project Pathの入力フィールドに `min-w-0` を追加、履歴セレクトに `w-20 shrink-0` を追加 |

### 問題の詳細

**現象**: モバイル画面において、「履歴」セレクト要素が `<option>` 内のパステキストの幅に引っ張られて横方向に広がり、左側の Project Path 入力フィールドを圧迫して見切れていた。

**原因**:
1. 履歴セレクトに幅の制限が設定されておらず、flexコンテナ内で `<option>` テキストの幅に応じて自動拡張されていた
2. 入力フィールドに `min-w-0` がなく、flexbox子要素のデフォルト最小幅（`min-width: auto`）により適切に縮小できなかった

### 修正内容

#### 行78: input要素に `min-w-0` クラスを追加

```tsx
// Before
className="flex-1 p-3 border border-gray-200 rounded-lg ..."

// After
className="flex-1 min-w-0 p-3 border border-gray-200 rounded-lg ..."
```

flexbox子要素は `min-width: auto` がデフォルトであり、コンテンツ幅以下に縮小されない。`min-w-0`（`min-width: 0`）を指定することで、`flex-1` による縮小が正常に機能するようになる。

#### 行84: select要素に `w-20 shrink-0` クラスを追加

```tsx
// Before
className="p-3 border border-gray-200 rounded-lg ..."

// After
className="w-20 shrink-0 p-3 border border-gray-200 rounded-lg ..."
```

- `w-20`（`width: 80px`）: セレクト要素の幅を80pxに固定。`<option>` テキストの長さに引っ張られることを防止
- `shrink-0`（`flex-shrink: 0`）: flexコンテナ内で縮小されないことを保証

### 計画からの変更点

特になし

### 実装時の課題

#### ビルド・テストで苦戦した点

特になし

#### 技術的に難しかった点

特になし。flexboxの `min-width: auto` はモバイルレイアウトで頻出する既知の問題であり、`min-w-0` の付与が定石の解決策。

### 残存する懸念点

- `w-20`（80px）は「履歴」という2文字のラベルとドロップダウン矢印が収まる最小限の幅として設定されている。UIフォントサイズの変更やラベルテキストの変更時には幅の再調整が必要になる可能性がある
- `<option>` 内のパステキストは末尾2セグメント（例: `myproject/src`）を表示しているが、セレクトのドロップダウン展開時にはブラウザがオプションテキストの幅に応じて自動的にポップアップ幅を調整するため、ユーザーはパスの内容を確認可能

### 検証結果

| 検証項目 | 結果 |
|---------|------|
| TypeScript型チェック | エラー0件 |
| ESLint | 今回の変更に関連するエラーなし |
| ビルド | TypeScriptコンパイル成功（既存の `/_global-error` プリレンダリングエラーは今回の変更と無関係） |

### 動作確認フロー

```
1. フロントエンド開発サーバーを起動する（make frontend）
2. ブラウザでアプリケーションにアクセスする
3. Project Pathに任意のパスを入力し、複数回コマンドを実行して履歴を蓄積する
4. ブラウザの開発者ツールでモバイル表示（375px幅など）に切り替える
5. Project Path入力フィールドと履歴セレクトが横並びで正常に表示されることを確認する
6. 履歴セレクトが80px幅に固定され、入力フィールドを圧迫していないことを確認する
7. 入力フィールドのテキストが見切れずに表示されることを確認する
8. 履歴セレクトをタップしてドロップダウンを展開し、パステキストが読める状態であることを確認する
9. 履歴からパスを選択し、入力フィールドに正しく反映されることを確認する
```

### デプロイ後の確認事項

- [ ] モバイル実機（iPhone / Android）でProject Pathセクションのレイアウトが正常であること
- [ ] 履歴セレクトのドロップダウンが展開でき、パスが選択可能であること
- [ ] デスクトップ画面でレイアウトに影響がないこと
